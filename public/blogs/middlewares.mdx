---
title: Middlewares
seoTitle: Middlewares & shit
summary: A walkthrough over security headers setup with middlewares 
isReleased: true
lastModDate: 2021-04-20T09:15:00-0400
firstModDate: 2024-02-01T09:15:00-0400
minutesToRead: 7
tags:
  - 'middlewares'
  - 'security'
  - 'go'
---

<H3>Server</H3>
<C>
  First you might want to yeet the **`Server`** & **`X-Powered-By`** headers (the latter being
  unofficial), preferably through the server configs, or check `no_srv.go`. I have metioned this actually <L href='#using-go'>here</L> before
<S/>
> _Security through obscurity ain’t all that chief, but it's just a good complementary security measure._

To test that you've removed this entirely you can use curl:
</C>

<Code
  code=

{`➜ ~ curl -IsL https://https://www.google.com/ | grep -i server

server: gws

server: gws

`}
language="bash"
showLineNumbers={true}

> </Code>

<C>
Google doesn't hide this info, but guess who does ?

The feds
</C>
<Code
  code=

{`
➜  ~ curl -IsL https://cia.gov/ | grep -i server

➜  ~
`}
language="bash"
showLineNumbers={true}

> </Code>
<H3>Content Security Policy</H3>
<C>
Don't use `unsafe-inline` directive.
<S/>
`NextJS v13+` has a server implementation for homogeneous apps view <L href='https://nextjs.org/docs/app/building-your-application/configuring/content-security-policy'>reference</L> 
</C>
<H3 id='using-go'>Using Go</H3>
<C>Here's a simplified version of it</C>
<Code
  code=

{`w.Header().Set("Cross-Origin-Resource-Policy", "same-origin")
w.Header().Set("Cross-Origin-Embedder-Policy", "require-corp")
w.Header().Set("Permissions-Policy", "accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), camera=(), clipboard-read=(), clipboard-write=(), cross-origin-isolated=(), display-capture=(), document-domain=(), encrypted-media=(), execution-while-not-rendered=(), execution-while-out-of-viewport=(), fullscreen=(), gamepad=(), geolocation=(self 'https://trusted.com'), gyroscope=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), speaker=(), speaker-selection=(), sync-xhr=(), usb=(), web-share=(), xr-spatial-tracking=()")
`}
language="go"
showLineNumbers={true}

> </Code>
